<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>piano</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/15.1.3/Tone.js">

    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            background-color: black;
        }

        #textarea {
            margin: 1rem;
            background-color: black;
            color: white;
            width: 400px;
            height: 400px;
        }

        #keyboard {
            width: 400px;
            height: 160px;
            margin: 1rem;
            border: 1px solid darkgray;


        }

        .line {
            display: flex;
        }

        .key {
            border: 1px solid darkgray;
            background-color: black;
            color: white;
            text-align: center;
            font-size: xx-small;
            width: 30px;
            height: 30px;
            margin-left: 5px;
            margin-top: 5px;
        }
    </style>
</head>

<body>
    <div id="root">
        <textarea id="textarea"></textarea>
    </div>
    <div id="keyboard">
        <div class="line">
            <div class="key 1 !">!<br>1</div>
            <div class="key 2 @">@<br>2</div>
            <div class="key 3"><br>3</div>
            <div class="key 4 $">$<br>4</div>
            <div class="key 5 %">%<br>5</div>
            <div class="key 6 ^">^<br>6</div>
            <div class="key 7"><br>7</div>
            <div class="key 8 *">8<br>8</div>
            <div class="key 9 (">(<br>9</div>
            <div class="key 0 )"><br>0</div>
        </div>
        <div class="line" style="margin-left:15px;">
            <div class="key q Q">Q<br>q</div>
            <div class="key w W">W<br>w</div>
            <div class="key e E">E<br>e</div>
            <div class="key r"><br>r</div>
            <div class="key t T">T<br>t</div>
            <div class="key y Y">Y<br>y</div>
            <div class="key u"><br>u</div>
            <div class="key i I">I<br>i</div>
            <div class="key o O">O<br>o</div>
            <div class="key p P">P<br>p</div>
        </div>
        <div class="line">
            <div class="key Shift"><br>Shift</div>
            <div class="key a">a</div>
            <div class="key s S">S<br>s</div>
            <div class="key d D">D<br>d</div>
            <div class="key f"><br>f</div>
            <div class="key g G">G<br>g</div>
            <div class="key h H">H<br>h</div>
            <div class="key j J">J<br>j</div>
            <div class="key k"><br>k</div>
            <div class="key l L">L<br>l</div>
        </div>
        <div class="line" style="margin-left:45px;">
            <div class="key z Z">Z<br>z</div>
            <div class="key x"><br>x</div>
            <div class="key c C">C<br>c</div>
            <div class="key v V">V<br>v</div>
            <div class="key b B">B<br>b</div>
            <div class="key n"><br>n</div>
            <div class="key m M">M<br>m</div>
        </div>
    </div>
    <script>

        const keyMap = {
            "1": "C1",
            "!": "C#1",
            "2": "D1",
            "@": "D#1",
            "3": "E1",
            "4": "F1",
            "$": "F#1",
            "5": "G1",
            "%": "G#1",
            "6": "A1",
            "^": "A#1",
            "7": "B1",
            "8": "C2",
            "*": "C#2",
            "9": "D2",
            "(": "D#2",
            "0": "E2",
            "q": "F2",
            "Q": "F#2",
            "w": "G2",
            "W": "G#2",
            "e": "A2",
            "E": "A#2",
            "r": "B2",
            "t": "C3",
            "T": "C#3",
            "y": "D3",
            "Y": "D#3",
            "u": "E3",
            "i": "F3",
            "I": "F#3",
            "o": "G3",
            "O": "G#3",
            "p": "A3",
            "P": "A#3",
            "a": "B3",
            "s": "C4",
            "S": "C#4",
            "d": "D4",
            "D": "D#4",
            "f": "E4",
            "g": "F4",
            "G": "F#4",
            "h": "G4",
            "H": "G#4",
            "h": "G4",
            "j": "A4",
            "J": "A#4",
            "k": "B4",
            "l": "C5",
            "L": "C#5",
            "z": "D5",
            "Z": "D#5",
            "x": "E5",
            "c": "F5",
            "C": "F#5",
            "v": "G5",
            "V": "G#5",
            "b": "A5",
            "B": "A#5",
            "n": "B5",
            "m": "C6",
            "M": "C#6"
        };
    </script>
    <script>
        textarea.addEventListener('keydown', function (e) {

            const synth = new Tone.PolySynth().toDestination();

            if (!e.repeat) {
                try {
                    console.log(e.key);
                    console.log(document.getElementsByClassName(e.key + ''));
                    let keyElement = document.getElementsByClassName(e.key + '')[0];
                    keyElement.style.backgroundColor = 'white';
                    let k = keyMap[e.key];
                    if (k != undefined) {
                        synth.triggerAttackRelease(k, '8n');
                    }
                } catch (e) {
                    console.log(e);
                }
            }
        });
        textarea.addEventListener('keyup', function (e) {

            try {
                console.log(e.key);
                console.log(document.getElementsByClassName(e.key + ''));
                let keyElement = document.getElementsByClassName(e.key + '')[0];
                keyElement.style.backgroundColor = 'black';
            } catch (e) {
                console.log(e);
            }
        });
    </script>

</body>

</html>